skip_lfs: true

commit-msg:
  commands:
    "lint commit message":
      run: pnpm commitlint --edit {1}

pre-push:
  parallel: true
  jobs:
    - run: pnpm lint .
    - run: pnpm markdown:lint .

    - run: go mod download && go build -v ./...

    - run: golangci-lint run ./...
    - run: golangci-lint fmt ./...
    - run: go test -cover ./...

pre-commit:
  parallel: true
  jobs:
    - run: pnpm lint:fix .
      glob: "*"
      stage_fix: true
    - run: pnpm markdown:format {staged_files}
      glob: "*.md"
      stage_fix: true

    - run: go generate ./...
      glob: "*.go"

    - run: go mod download && go build -v ./...
      glob: "*.go"

    - run: golangci-lint run --fix ./...
      glob: "*.go"
      stage_fix: true
    - run: golangci-lint fmt ./...
      glob: "*.go"
      stage_fix: true

    - run: go test -cover ./...
      glob: "*.go"
